{"ast":null,"code":"export default {\n  name: 'HistoryQuery',\n\n  data() {\n    return {\n      options: [{\n        value: '1',\n        label: '标本名称',\n        disabled: false\n      }, {\n        value: '2',\n        label: '标本部位',\n        disabled: false\n      }, {\n        value: '3',\n        label: '上传时间',\n        disabled: false\n      }],\n      pickerOptions: {\n        shortcuts: [{\n          text: '最近一周',\n\n          onClick(picker) {\n            const end = new Date();\n            const start = new Date();\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);\n            picker.$emit('pick', [start, end]);\n          }\n\n        }, {\n          text: '最近一个月',\n\n          onClick(picker) {\n            const end = new Date();\n            const start = new Date();\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);\n            picker.$emit('pick', [start, end]);\n          }\n\n        }, {\n          text: '最近三个月',\n\n          onClick(picker) {\n            const end = new Date();\n            const start = new Date();\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);\n            picker.$emit('pick', [start, end]);\n          }\n\n        }]\n      },\n      searchValue: '1',\n      searchText: '',\n      dateRange: '',\n      isSearch: false,\n      isFiltrate: true\n    };\n  },\n\n  computed: {\n    filterFirstBorder() {\n      if (!this.isFiltrate) {\n        return {\n          'border-radius': '40px 40px 40px 40px'\n        };\n      } else {\n        return {\n          'border-radius': '40px 0 0 40px'\n        };\n      }\n    },\n\n    filterLastBackground() {\n      if (!this.isSearch) {\n        return {\n          'background-image': 'linear-gradient(135deg, #6cc3de 0%, #767ff6 100%)'\n        };\n      } else {\n        return {\n          'background-image': 'linear-gradient(135deg, #ff833b 0%, #cc0c0c 74%)'\n        };\n      }\n    }\n\n  },\n  methods: {\n    changeFilterState() {\n      this.isFiltrate = !this.isFiltrate;\n    },\n\n    filterLastEvent() {\n      if (!this.isSearch) {\n        this.searchNewHistory();\n      } else {\n        this.getAllHistory();\n      }\n    },\n\n    searchNewHistory() {\n      if (this.searchValue === '1') {\n        // 根据标本名字搜索\n        this.$bus.$emit('updateHistoryPageWithFilter', {\n          \"filterType\": 1,\n          \"filterValue\": this.searchText\n        });\n      } else if (this.searchValue === '2') {\n        // 根据标本部位搜索\n        this.$bus.$emit('updateHistoryPageWithFilter', {\n          \"filterType\": 2,\n          \"filterValue\": this.searchText\n        });\n      } else if (this.searchValue === '3') {\n        // 根据标本上传时间段搜索\n        if (this.dateRange === '') {\n          this.$message({\n            showClose: true,\n            message: '搜索条件不能为空',\n            type: 'error'\n          });\n          return;\n        }\n\n        this.$bus.$emit('updateHistoryPageWithFilter', {\n          \"filterType\": 3,\n          \"filterValue\": this.dateRange\n        });\n      }\n\n      this.isSearch = true;\n    },\n\n    getAllHistory() {\n      this.$bus.$emit('noFilter');\n      this.$bus.$emit('updateHistoryPage');\n      this.isSearch = false;\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAqEA;EACAA,oBADA;;EAGAC;IACA;MACAC;QACAC,UADA;QAEAC,aAFA;QAGAC;MAHA,GAIA;QACAF,UADA;QAEAC,aAFA;QAGAC;MAHA,CAJA,EAQA;QACAF,UADA;QAEAC,aAFA;QAGAC;MAHA,CARA,CADA;MAcAC;QACAC;UACAC,YADA;;UAEAC;YACA;YACA;YACAC;YACAC;UACA;;QAPA,GAQA;UACAH,aADA;;UAEAC;YACA;YACA;YACAC;YACAC;UACA;;QAPA,CARA,EAgBA;UACAH,aADA;;UAEAC;YACA;YACA;YACAC;YACAC;UACA;;QAPA,CAhBA;MADA,CAdA;MAyCAC,gBAzCA;MA0CAC,cA1CA;MA2CAC,aA3CA;MA4CAC,eA5CA;MA6CAC;IA7CA;EA+CA,CAnDA;;EAoDAC;IACAC;MACA;QACA;UAAA;QAAA;MACA,CAFA,MAEA;QACA;UAAA;QAAA;MACA;IACA,CAPA;;IAQAC;MACA;QACA;UAAA;QAAA;MACA,CAFA,MAEA;QACA;UAAA;QAAA;MACA;IACA;;EAdA,CApDA;EAoEAC;IACAC;MACA;IACA,CAHA;;IAIAC;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA;IACA,CAVA;;IAWAC;MACA;QACA;QACA;UAAA;UAAA;QAAA;MACA,CAHA,MAIA;QACA;QACA;UAAA;UAAA;QAAA;MACA,CAHA,MAIA;QACA;QACA;UACA;YACAC,eADA;YAEAC,mBAFA;YAGAC;UAHA;UAKA;QACA;;QACA;UAAA;UAAA;QAAA;MACA;;MACA;IACA,CAjCA;;IAkCAC;MACA;MACA;MACA;IACA;;EAtCA;AApEA","names":["name","data","options","value","label","disabled","pickerOptions","shortcuts","text","onClick","start","picker","searchValue","searchText","dateRange","isSearch","isFiltrate","computed","filterFirstBorder","filterLastBackground","methods","changeFilterState","filterLastEvent","searchNewHistory","showClose","message","type","getAllHistory"],"sourceRoot":"src/components/history","sources":["HistoryQuery.vue"],"sourcesContent":["<template>\r\n  <el-row class=\"query-container\">\r\n    <button class=\"filter-first\" :style=\"filterFirstBorder\" @click=\"changeFilterState()\">\r\n      <div class=\"filter-holder\">\r\n        <i class=\"iconfont icon-shaixuan\" style=\"vertical-align: middle\"></i>\r\n        <span>  筛选</span>\r\n      </div>\r\n    </button>\r\n    <div style=\"width: 15%;height: 90%;justify-content: center;align-items: center;display: flex\" v-show=\"isFiltrate\">\r\n      <el-select v-model=\"searchValue\" placeholder=\"请选择搜索方式\" :popper-append-to-body=\"false\" @change=\"searchText='';dateRange='';isSearch=false\">\r\n        <el-option\r\n          v-for=\"item in options\"\r\n          :key=\"item.value\"\r\n          :label=\"item.label\"\r\n          :value=\"item.value\"\r\n          :disabled=\"item.disabled\"\r\n        >\r\n        </el-option>\r\n      </el-select>\r\n    </div>\r\n    <div class=\"filter-third\" style=\"width: 70%;height: 90%;justify-content: center;align-items: center;display: flex\" v-show=\"isFiltrate\">\r\n      <el-input\r\n        v-show=\"searchValue === '1'\"\r\n        placeholder=\"请输入标本名称\"\r\n        v-model=\"searchText\"\r\n        ref=\"search\"\r\n        clearable\r\n        prefix-icon=\"el-icon-search\"\r\n        @keyup.enter.native=\"searchNewHistory()\"\r\n      ></el-input>\r\n      <el-input\r\n        v-show=\"searchValue === '2'\"\r\n        placeholder=\"请输入标本部位\"\r\n        v-model=\"searchText\"\r\n        ref=\"search\"\r\n        clearable\r\n        prefix-icon=\"el-icon-search\"\r\n        @keyup.enter.native=\"searchNewHistory()\"\r\n      ></el-input>\r\n      <el-date-picker\r\n        v-show=\"searchValue === '3'\"\r\n        v-model=\"dateRange\"\r\n        type=\"daterange\"\r\n        align=\"right\"\r\n        unlink-panels\r\n        range-separator=\"至\"\r\n        start-placeholder=\"开始日期\"\r\n        end-placeholder=\"结束日期\"\r\n        :picker-options=\"pickerOptions\"\r\n        @blur=\"searchNewHistory()\"\r\n        style=\"width: 100%\"\r\n      >\r\n      </el-date-picker>\r\n    </div>\r\n    <button class=\"filter-last\" :style=\"filterLastBackground\" @click=\"filterLastEvent()\" v-show=\"isFiltrate\">\r\n      <div v-show=\"!isSearch\" class=\"filter-starter\">\r\n        <i class=\"el-icon-check\" style=\"vertical-align: middle\"></i>\r\n        <span>  确定</span>\r\n      </div>\r\n      <div v-show=\"isSearch\" class=\"filter-closer\">\r\n        <i class=\"el-icon-close\" style=\"vertical-align: middle\"></i>\r\n        <span>  取消</span>\r\n      </div>\r\n    </button>\r\n  </el-row>\r\n</template>\r\n\r\n<script>\r\n\r\nexport default {\r\n  name: 'HistoryQuery',\r\n\r\n  data() {\r\n    return {\r\n      options: [{\r\n        value: '1',\r\n        label: '标本名称',\r\n        disabled: false,\r\n      }, {\r\n        value: '2',\r\n        label: '标本部位',\r\n        disabled: false,\r\n      }, {\r\n        value: '3',\r\n        label: '上传时间',\r\n        disabled: false,\r\n      }],\r\n      pickerOptions: {\r\n        shortcuts: [{\r\n          text: '最近一周',\r\n          onClick(picker) {\r\n            const end = new Date();\r\n            const start = new Date();\r\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);\r\n            picker.$emit('pick', [start, end]);\r\n          }\r\n        }, {\r\n          text: '最近一个月',\r\n          onClick(picker) {\r\n            const end = new Date();\r\n            const start = new Date();\r\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);\r\n            picker.$emit('pick', [start, end]);\r\n          }\r\n        }, {\r\n          text: '最近三个月',\r\n          onClick(picker) {\r\n            const end = new Date();\r\n            const start = new Date();\r\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);\r\n            picker.$emit('pick', [start, end]);\r\n          }\r\n        }]\r\n      },\r\n      searchValue: '1',\r\n      searchText: '',\r\n      dateRange: '',\r\n      isSearch: false,\r\n      isFiltrate: true\r\n    }\r\n  },\r\n  computed: {\r\n    filterFirstBorder() {\r\n      if (!this.isFiltrate) {\r\n        return { 'border-radius': '40px 40px 40px 40px' };\r\n      } else {\r\n        return { 'border-radius': '40px 0 0 40px' };\r\n      }\r\n    },\r\n    filterLastBackground(){\r\n      if (!this.isSearch) {\r\n        return { 'background-image': 'linear-gradient(135deg, #6cc3de 0%, #767ff6 100%)' };\r\n      } else {\r\n        return { 'background-image': 'linear-gradient(135deg, #ff833b 0%, #cc0c0c 74%)' };\r\n      }\r\n    }\r\n  },\r\n  methods:{\r\n    changeFilterState() {\r\n      this.isFiltrate = !this.isFiltrate;\r\n    },\r\n    filterLastEvent(){\r\n      if (!this.isSearch) {\r\n        this.searchNewHistory();\r\n      } else {\r\n        this.getAllHistory();\r\n      }\r\n    },\r\n    searchNewHistory(){\r\n      if (this.searchValue === '1'){\r\n        // 根据标本名字搜索\r\n        this.$bus.$emit('updateHistoryPageWithFilter', {\"filterType\": 1, \"filterValue\": this.searchText});\r\n      }\r\n      else if (this.searchValue === '2'){\r\n        // 根据标本部位搜索\r\n        this.$bus.$emit('updateHistoryPageWithFilter', {\"filterType\": 2, \"filterValue\": this.searchText});\r\n      }\r\n      else if (this.searchValue === '3'){\r\n        // 根据标本上传时间段搜索\r\n        if (this.dateRange === ''){\r\n          this.$message({\r\n            showClose: true,\r\n            message: '搜索条件不能为空',\r\n            type: 'error',\r\n          });\r\n          return;\r\n        }\r\n        this.$bus.$emit('updateHistoryPageWithFilter', {\"filterType\": 3, \"filterValue\": this.dateRange});\r\n      }\r\n      this.isSearch = true;\r\n    },\r\n    getAllHistory(){\r\n      this.$bus.$emit('noFilter');\r\n      this.$bus.$emit('updateHistoryPage');\r\n      this.isSearch = false;\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.query-container button {\r\n\tborder: none;\r\n\toutline: none;\r\n}\r\n\r\n.query-container {\r\n  width: 1300px;\r\n  height: 75px;\r\n  margin: 0 auto;\r\n  padding-bottom: 10px;\r\n  display: flex;\r\n  justify-content: start;\r\n  align-items: center;\r\n  flex-direction: row;\r\n}\r\n\r\n.filter-first {\r\n  width: 7%;\r\n  height: 40px;\r\n  justify-content: center;\r\n  align-items: center;\r\n  display: flex;\r\n  background-image: linear-gradient(45deg, #7de1ff 0%, #85FFBD 100%);\r\n  cursor: pointer;\r\n  transition: 0.15s ease;\r\n}\r\n\r\n.filter-holder {\r\n  color: #ffffff;\r\n  font-size: 14px;\r\n  font-weight: bold;\r\n  transition: 0.15s ease;\r\n}\r\n\r\n.filter-first:hover {\r\n  opacity: .8;\r\n}\r\n\r\n.filter-first:hover .filter-holder{\r\n  color: #1d5a7d;\r\n}\r\n\r\n.filter-last {\r\n  width: 8%;\r\n  height: 40px;\r\n  justify-content: center;\r\n  align-items: center;\r\n  display: flex;\r\n  border-radius: 0 40px 40px 0;\r\n  cursor: pointer;\r\n  transition: 0.15s ease;\r\n}\r\n\r\n.filter-last:hover {\r\n  opacity: 0.8;\r\n}\r\n\r\n.filter-starter,.filter-closer {\r\n  color: #ffffff;\r\n  transition: 0.15s ease;\r\n  font-size: 14px;\r\n  font-weight: bold;\r\n}\r\n\r\n.filter-last:hover .filter-starter,.filter-closer{\r\n  color: #e5e3e3;\r\n}\r\n\r\n.query-container .el-select >>> .el-input__inner {\r\n  border-radius: 0;\r\n  border-left: transparent;\r\n}\r\n\r\n.query-container .el-select >>> .el-input.is-focus .el-input__inner {\r\n  border-color: #3ae6cc !important;\r\n}\r\n\r\n.query-container .el-select >>> .el-input__inner:focus {\r\n  border-color: #3ae6cc !important;\r\n}\r\n\r\n.query-container .el-select >>> .el-scrollbar .el-select-dropdown__item.selected {\r\n  color: #3ae6cc;\r\n}\r\n\r\n.query-container .el-input >>> .el-input__inner {\r\n  border-radius: 0;\r\n}\r\n\r\n.filter-third .el-input >>> .el-input__inner:focus {\r\n  border-color: #3ae6cc !important;\r\n}\r\n\r\n.filter-third .el-date-editor.el-input__inner {\r\n  border-radius: 0;\r\n}\r\n\r\n.filter-third .el-range-editor.is-active {\r\n  border-color: #3ae6cc !important;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}