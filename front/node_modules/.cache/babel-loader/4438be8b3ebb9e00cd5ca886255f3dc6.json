{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nexport default {\n  name: \"P_AccountPage\",\n\n  data() {\n    const validatePass = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请输入密码'));\n      } else {\n        if (this.registerForm.checkPass !== '') {\n          this.$refs.registerForm.validateField('checkPass');\n        }\n\n        callback();\n      }\n    };\n\n    const validatePass2 = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请再次输入密码'));\n      } else if (value !== this.registerForm.password) {\n        callback(new Error('两次输入密码不一致!'));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      sliderType: \"mainContainer_switch_slider_left\",\n      validateCodeSending: false,\n      loginForm: {\n        account: \"\",\n        password: \"\"\n      },\n      loginFormRule: {\n        account: [{\n          required: true,\n          message: '请输入账户信息(邮箱地址)',\n          trigger: 'blur'\n        }],\n        password: [{\n          required: true,\n          message: '请输入密码',\n          trigger: 'blur'\n        }]\n      },\n      registerForm: {\n        account: \"\",\n        password: \"\",\n        checkPass: \"\",\n        vCode: \"\"\n      },\n      registerFormRule: {\n        account: [{\n          required: true,\n          message: '请输入账户信息(邮箱地址)',\n          trigger: 'change'\n        }],\n        password: [{\n          required: true,\n          validator: validatePass,\n          trigger: 'blur'\n        }],\n        checkPass: [{\n          required: true,\n          validator: validatePass2,\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n\n  methods: {\n    switchPage(w) {\n      if (w === 1) {\n        this.sliderType = \"mainContainer_switch_slider_left\";\n      } else if (w === 2) {\n        this.sliderType = \"mainContainer_switch_slider_right\";\n      }\n    },\n\n    getCookie(objname) {\n      //获取指定名称的cookie的值\n      const arrstr = document.cookie.split(\"; \");\n\n      for (var i = 0; i < arrstr.length; i++) {\n        var temp = arrstr[i].split(\"=\");\n        if (temp[0] === objname) return temp[1];\n      }\n\n      return null;\n    },\n\n    setCookie(name, value, hours, path) {\n      const expires = new Date();\n      expires.setTime(expires.getTime() + hours * 3600000);\n      path = path === \"\" ? \"\" : \";path=\" + path;\n\n      const _expires = typeof hours == \"string\" ? \"\" : \";expires=\" + expires.toUTCString();\n\n      document.cookie = name + \"=\" + value + _expires + path;\n    },\n\n    loginCheck() {\n      if (this.loginForm.account === \"\" || this.loginForm.password === \"\") {\n        alert(\"请首先输入账号和密码\");\n        return;\n      }\n\n      this.$axios.post('/NBI/User/checkLogin/', {\n        \"uid\": this.loginForm.account,\n        \"pwd\": this.loginForm.password,\n        \"token\": this.getCookie(\"NBI_token\")\n      }).then(response => {\n        if (response.data === 1) {\n          alert(\"该邮箱未注册！\");\n        } else if (response.data === 2) {\n          alert(\"密码错误！\");\n        } else {\n          // 登录成功\n          this.setCookie(\"NBI_token\", response.data.token, 2, \"/NBI\");\n          this.setCookie(\"NBI_UID\", response.data.uid, 72, \"/NBI\");\n          this.$bus.$emit('changeStatus', {\n            status: true,\n            uname: response.data.uname\n          });\n\n          if (this.$refs.rememAC.checked) {\n            //记录pwd\n            this.setCookie(\"NBI_pwd\", this.loginForm.password, 72, \"/NBI\");\n          }\n\n          alert(\"登录成功！页面将会自动跳转\");\n          setTimeout(() => {\n            this.$router.push({\n              path: \"/ImageProcess\"\n            });\n          }, 2000);\n        }\n      });\n    },\n\n    checkEmail(email) {\n      const myReg = /^[a-zA-Z0-9_-]+@([a-zA-Z0-9]+\\.)+(com|cn|net|org)$/;\n      return myReg.test(email);\n    },\n\n    registerCheck() {\n      if (this.registerForm.checkPass !== this.registerForm.password) {\n        alert(\"两次密码输入不一致\");\n        return;\n      }\n\n      if (this.registerForm.account === null || this.registerForm.password === null) {\n        alert(\"注册关键信息不能为空\");\n        return;\n      }\n\n      if (!this.checkEmail(this.registerForm.account)) {\n        alert(\"请输入符合规范的电子邮箱\");\n        return;\n      }\n\n      this.$axios.post('/NBI/User/register/', {\n        \"email\": this.registerForm.account,\n        \"pw\": this.registerForm.password\n      }).then(response => {\n        if (response.data === 0) {\n          alert(\"注册失败，该邮箱地址已被注册！\");\n          this.registerForm.account = \"\";\n          this.registerForm.password = \"\";\n        } else if (response.data === 1) {\n          alert(\"注册成功！请登录。\");\n          setTimeout(() => {\n            this.switchPage(1);\n          }, 3000);\n        }\n      });\n    }\n\n  },\n\n  mounted() {\n    const pwd = this.getCookie(\"NBI_pwd\");\n\n    if (pwd != null) {\n      this.loginForm.password = pwd;\n      this.loginForm.account = this.getCookie(\"NBI_UID\");\n      this.$refs.rememAC.checked = true;\n    }\n\n    this.switchPage(this.$route.query.w);\n  }\n\n};","map":{"version":3,"mappings":";AA2DA;EACAA,qBADA;;EAEAC;IACA;MACA;QACAC;MACA,CAFA,MAEA;QACA;UACA;QACA;;QACAA;MACA;IACA,CATA;;IAUA;MACA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA;IACA,CARA;;IASA;MACAC,8CADA;MAEAC,0BAFA;MAGAC;QACAC,WADA;QAEAC;MAFA,CAHA;MAOAC;QACAF,UACA;UAAAG;UAAAC;UAAAC;QAAA,CADA,CADA;QAIAJ,WACA;UAAAE;UAAAC;UAAAC;QAAA,CADA;MAJA,CAPA;MAeAC;QACAN,WADA;QAEAC,YAFA;QAGAM,aAHA;QAIAC;MAJA,CAfA;MAqBAC;QACAT,UACA;UAAAG;UAAAC;UAAAC;QAAA,CADA,CADA;QAIAJ,WACA;UAAAE;UAAAO;UAAAL;QAAA,CADA,CAJA;QAOAE,YACA;UAAAJ;UAAAO;UAAAL;QAAA,CADA;MAPA;IArBA;EAiCA,CAvDA;;EAwDAM;IACAC;MACA;QACA;MACA,CAFA,MAGA;QACA;MACA;IACA,CARA;;IASAC;MAAA;MACA;;MACA;QACA;QACA;MACA;;MACA;IACA,CAhBA;;IAiBAC;MACA;MACAC;MACAC;;MACA;;MACAC;IACA,CAvBA;;IAwBAC;MACA;QACAC;QACA;MACA;;MACA;QACA,6BADA;QAEA,8BAFA;QAGA;MAHA,GAIAC,IAJA,CAIAC;QACA;UACAF;QACA,CAFA,MAGA;UACAA;QACA,CAFA,MAGA;UACA;UACA;UACA;UACA;YAAAG;YAAAC;UAAA;;UACA;YACA;YACA;UACA;;UACAJ;UACAK;YACA;cAAAR;YAAA;UACA,CAFA,EAEA,IAFA;QAGA;MACA,CAzBA;IA0BA,CAvDA;;IAwDAS;MACA;MACA;IACA,CA3DA;;IA4DAC;MACA;QACAP;QACA;MACA;;MACA;QACAA;QACA;MACA;;MACA;QACAA;QACA;MACA;;MACA;QACA,kCADA;QAEA;MAFA,GAGAC,IAHA,CAGAC;QACA;UACAF;UACA;UACA;QACA,CAJA,MAKA;UACAA;UACAK;YACA;UACA,CAFA,EAEA,IAFA;QAGA;MACA,CAfA;IAgBA;;EAzFA,CAxDA;;EAmJAG;IACA;;IACA;MACA;MACA;MACA;IACA;;IACA;EACA;;AA3JA","names":["name","data","callback","sliderType","validateCodeSending","loginForm","account","password","loginFormRule","required","message","trigger","registerForm","checkPass","vCode","registerFormRule","validator","methods","switchPage","getCookie","setCookie","expires","path","document","loginCheck","alert","then","response","status","uname","setTimeout","checkEmail","registerCheck","mounted"],"sourceRoot":"src/pages","sources":["AccountPage.vue"],"sourcesContent":["<template>\r\n  <div id=\"mainContainer\">\r\n    <div id=\"mainContainerInner\">\r\n      <div id=\"switchBtnContainer\">\r\n\t\t\t\t<button class=\"switchBtn\" @click=\"switchPage(1);\" title=\"登录您的账号\" id=\"user_loginBtn\">登&emsp;&emsp;录</button>\r\n\t\t\t\t<button class=\"switchBtn\" @click=\"switchPage(2);\" title=\"注册新的账号\" id=\"user_registerBtn\">注&emsp;&emsp;册</button>\r\n\t\t\t</div>\r\n      <div style=\"width: 94%;margin-left: 3%;margin-top: 6px;height: 3px;border-radius: 5%;background-color: #AAAAFF;\"></div>\r\n      <div id=\"mainContainer_switch\">\r\n        <div :class=\"sliderType\">\r\n          <!--账号登录-->\r\n          <div id=\"user_subPage_login\">\r\n            <el-form class=\"loginForm\" :rules=\"loginFormRule\" ref=\"loginForm\" :model=\"loginForm\" label-width=\"50px\">\r\n              <el-form-item label=\"账户\" prop=\"account\">\r\n                <el-input v-model=\"loginForm.account\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"密码\" prop=\"password\">\r\n                <el-input type=\"password\" v-model=\"loginForm.password\" autocomplete=\"off\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <input ref=\"rememAC\" type=\"checkbox\" id=\"rememAC\" name=\"rememAC\"/>\r\n                <label for=\"rememAC\" style=\"cursor: pointer;margin-right:9rem;color: blue;font-size: 16px;line-height: 30px;\">记住我</label>\r\n                <a class=\"fontLink\" style=\"margin-left: 10%\" @click=\"switchPage(2)\">没有账号？立即注册</a>\r\n              </el-form-item>\r\n              <input type=\"button\" id=\"loginBtn\" @click=\"loginCheck()\" value=\"登      录\"/>\r\n            </el-form>\r\n          </div>\r\n\r\n          <!--账号注册-->\r\n          <div id=\"user_subPage_register\">\r\n            <el-form class=\"registerForm\" :rules=\"registerFormRule\" ref=\"registerForm\" :model=\"registerForm\" label-width=\"18%\">\r\n              <el-form-item label=\"账户\" prop=\"account\">\r\n                <el-input v-model=\"registerForm.account\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"密码\" prop=\"pass\">\r\n                <el-input type=\"password\" v-model=\"registerForm.password\" autocomplete=\"off\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"确认密码\" prop=\"checkPass\">\r\n                <el-input type=\"password\" v-model=\"registerForm.checkPass\" autocomplete=\"off\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"验证码\" prop=\"vCode\">\r\n                <el-input style=\"width: 75%\" v-model=\"registerForm.vCode\" autocomplete=\"off\"></el-input>\r\n                <el-button style=\"margin-left: 5%;width: 20%;\" type=\"primary\" :loading=\"validateCodeSending\">发送</el-button>\r\n              </el-form-item>\r\n              <input type=\"button\" id=\"registerBtn\" @click=\"registerCheck()\" value=\"注      册\"/>\r\n            </el-form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- slogan -->\r\n    <div id=\"slogan\">\r\n        <p>-&emsp;登录NBI-Online解锁完整功能&emsp;-</p>\r\n    </div>\r\n  </div>\r\n\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"P_AccountPage\",\r\n  data() {\r\n    const validatePass = (rule, value, callback) => {\r\n      if (value === '') {\r\n        callback(new Error('请输入密码'));\r\n      } else {\r\n        if (this.registerForm.checkPass !== '') {\r\n          this.$refs.registerForm.validateField('checkPass');\r\n        }\r\n        callback();\r\n      }\r\n    };\r\n    const validatePass2 = (rule, value, callback) => {\r\n      if (value === '') {\r\n        callback(new Error('请再次输入密码'));\r\n      } else if (value !== this.registerForm.password) {\r\n        callback(new Error('两次输入密码不一致!'));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    return {\r\n      sliderType: \"mainContainer_switch_slider_left\",\r\n      validateCodeSending: false,\r\n      loginForm: {\r\n        account: \"\",\r\n        password: \"\",\r\n      },\r\n      loginFormRule: {\r\n        account: [\r\n          { required: true, message: '请输入账户信息(邮箱地址)', trigger: 'blur' }\r\n        ],\r\n        password: [\r\n          { required: true, message: '请输入密码', trigger: 'blur' }\r\n        ]\r\n      },\r\n      registerForm:{\r\n        account: \"\",\r\n        password:\"\",\r\n        checkPass: \"\",\r\n        vCode: \"\",\r\n      },\r\n      registerFormRule: {\r\n        account: [\r\n          { required: true, message: '请输入账户信息(邮箱地址)', trigger: 'change' }\r\n        ],\r\n        password: [\r\n          { required: true,  validator: validatePass, trigger: 'blur' }\r\n        ],\r\n        checkPass: [\r\n          { required: true,  validator: validatePass2, trigger: 'blur' }\r\n        ],\r\n      },\r\n    }\r\n  },\r\n  methods:{\r\n    switchPage(w){\r\n      if (w===1){\r\n        this.sliderType = \"mainContainer_switch_slider_left\";\r\n      }\r\n      else if(w===2){\r\n        this.sliderType = \"mainContainer_switch_slider_right\";\r\n      }\r\n    },\r\n    getCookie(objname){//获取指定名称的cookie的值\r\n      const arrstr = document.cookie.split(\"; \");\r\n      for(var i = 0;i < arrstr.length;i ++){\r\n          var temp = arrstr[i].split(\"=\");\r\n          if(temp[0] === objname) return temp[1];\r\n      }\r\n      return null;\r\n    },\r\n    setCookie(name, value, hours, path) {\r\n      const expires = new Date();\r\n      expires.setTime(expires.getTime() + hours * 3600000);\r\n      path = path === \"\" ? \"\" : \";path=\" + path;\r\n      const _expires = (typeof hours) == \"string\" ? \"\" : \";expires=\" + expires.toUTCString();\r\n      document.cookie = name + \"=\" + value + _expires + path;\r\n    },\r\n    loginCheck(){\r\n      if (this.loginForm.account === \"\" || this.loginForm.password===\"\"){\r\n        alert(\"请首先输入账号和密码\");\r\n        return;\r\n      }\r\n      this.$axios.post('/NBI/User/checkLogin/', {\r\n        \"uid\": this.loginForm.account,\r\n        \"pwd\": this.loginForm.password,\r\n        \"token\": this.getCookie(\"NBI_token\"),\r\n      }).then((response) => {\r\n        if (response.data === 1){\r\n          alert(\"该邮箱未注册！\");\r\n        }\r\n        else if (response.data === 2){\r\n          alert(\"密码错误！\");\r\n        }\r\n        else{\r\n          // 登录成功\r\n          this.setCookie(\"NBI_token\",response.data.token, 2, \"/NBI\");\r\n          this.setCookie(\"NBI_UID\", response.data.uid, 72, \"/NBI\");\r\n          this.$bus.$emit('changeStatus', {status: true, uname: response.data.uname});\r\n          if (this.$refs.rememAC.checked){\r\n            //记录pwd\r\n            this.setCookie(\"NBI_pwd\", this.loginForm.password, 72, \"/NBI\");\r\n          }\r\n          alert(\"登录成功！页面将会自动跳转\");\r\n          setTimeout(()=>{\r\n            this.$router.push({path: \"/ImageProcess\"});\r\n          }, 2000);\r\n        }\r\n      });\r\n    },\r\n    checkEmail(email){\r\n      const myReg=/^[a-zA-Z0-9_-]+@([a-zA-Z0-9]+\\.)+(com|cn|net|org)$/;\r\n      return myReg.test(email);\r\n    },\r\n    registerCheck(){\r\n      if (this.registerForm.checkPass !== this.registerForm.password){\r\n        alert(\"两次密码输入不一致\");\r\n        return;\r\n      }\r\n      if (this.registerForm.account === null || this.registerForm.password === null){\r\n        alert(\"注册关键信息不能为空\");\r\n        return;\r\n      }\r\n      if (!this.checkEmail(this.registerForm.account)){\r\n        alert(\"请输入符合规范的电子邮箱\");\r\n        return;\r\n      }\r\n      this.$axios.post('/NBI/User/register/', {\r\n        \"email\": this.registerForm.account,\r\n        \"pw\": this.registerForm.password,\r\n      }).then((response) => {\r\n        if (response.data === 0){\r\n          alert(\"注册失败，该邮箱地址已被注册！\");\r\n          this.registerForm.account = \"\";\r\n          this.registerForm.password = \"\";\r\n        }\r\n        else if (response.data === 1){\r\n          alert(\"注册成功！请登录。\");\r\n          setTimeout(()=>{\r\n            this.switchPage(1);\r\n          }, 3000);\r\n        }\r\n      });\r\n    },\r\n  },\r\n  mounted(){\r\n    const pwd = this.getCookie(\"NBI_pwd\");\r\n    if (pwd != null){\r\n      this.loginForm.password = pwd;\r\n      this.loginForm.account = this.getCookie(\"NBI_UID\");\r\n      this.$refs.rememAC.checked = true;\r\n    }\r\n    this.switchPage(this.$route.query.w);\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n#mainContainer{\r\n    width: 30%;\r\n    height: 80%;\r\n    padding-top: 80px;\r\n    overflow: hidden;\r\n    /* display: flex; */\r\n    align-items: center;\r\n    /* justify-content: center; */\r\n}\r\n\r\n#mainContainerInner{\r\n    width: 100%;\r\n    /* 48 - 58 */\r\n    /* height: 48%; */\r\n    background-color: rgba(0, 123, 255, 0.189);\r\n    transition: 0.2s ease;\r\n    overflow: hidden;\r\n}\r\n\r\n#switchBtnContainer{\r\n\twidth: 100%;\r\n\tpadding-top: 20px;\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n}\r\n.switchBtn{\r\n\twidth: 46%;\r\n\theight: 40px;\r\n\tmargin: 5px;\r\n\tborder: royalblue solid 1px;\r\n\tbackground: #F8F8FF;\r\n\tcursor: pointer;\r\n\ttransition: all 0.2s ease;\r\n}\r\n.switchBtn:hover{\r\n\tbackground: #AAAAFF;\r\n}\r\n\r\n#mainContainer_switch{\r\n    overflow: hidden;\r\n}\r\n\r\n.mainContainer_switch_slider_left{\r\n    margin-top: 3%;\r\n    margin-left: 0;\r\n    width: 200%;\r\n    height: 285px;\r\n    display: flex;\r\n    flex-direction: row;\r\n    transition: all 0.2s ease;\r\n}\r\n\r\n.mainContainer_switch_slider_right{\r\n    margin-top: 3%;\r\n    margin-left: -100%;\r\n    width: 200%;\r\n    height: 350px;\r\n    display: flex;\r\n    flex-direction: row;\r\n    transition: all 0.2s ease;\r\n}\r\n\r\n#user_subPage_login{\r\n  width: 100%;\r\n  /*height: 100%;*/\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  flex-direction: column;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n#user_subPage_register{\r\n  width: 100%;\r\n  /*height: 100%;*/\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  flex-direction: column;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.loginForm{\r\n\twidth: 90%;\r\n\twhite-space: nowrap;\r\n}\r\n\r\n.registerForm{\r\n  width: 90%;\r\n\twhite-space: nowrap;\r\n}\r\n\r\ninput[type=\"checkbox\"] {\r\n    height: 18px;\r\n    width: 18px;\r\n    margin-top: 18px;\r\n    margin-left: 10px;\r\n}\r\n\r\n#rememAC{\r\n\tmargin-left: -30px;\r\n  cursor: pointer;\r\n}\r\n#loginBtn{\r\n\twidth: 100%;\r\n\theight: 45px;\r\n\tborder: #1122AA solid 1px;\r\n\tbackground: transparent;\r\n\tcursor: pointer;\r\n\ttransition: all 0.2s ease;\r\n}\r\n#loginBtn:hover{\r\n    background-color: rgba(61, 255, 61, 0.378);\r\n}\r\ninput[type=\"checkbox\"] {\r\n    height: 18px;\r\n    width: 18px;\r\n    margin-top: 18px;\r\n    margin-left: 10px;\r\n}\r\n\r\n.fontLink{\r\n\tcolor: #1122AA;\r\n\tfont-size: 16px;\r\n}\r\n.fontLink:hover{\r\n\tcolor: rgb(52, 86, 255);\r\n\tcursor: pointer;\r\n}\r\n\r\n#registerBtn{\r\n\twidth: 100%;\r\n\theight: 45px;\r\n    margin-top: 2px;\r\n\tborder: #1122AA solid 1px;\r\n\tbackground: transparent;\r\n\tcursor: pointer;\r\n\ttransition: all 0.2s ease;\r\n}\r\n#registerBtn:hover{\r\n\tcolor: white;\r\n    background-color: #2244CC;\r\n}\r\n#slogan{\r\n\twidth: 100%;\r\n\tmargin-top: 20px;\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n\talign-items: center;\r\n\tfont-family: Arial, Helvetica, sans-serif;\r\n\tcolor: grey;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}