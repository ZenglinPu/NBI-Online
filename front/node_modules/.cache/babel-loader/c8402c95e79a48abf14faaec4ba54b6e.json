{"ast":null,"code":"export default {\n  name: \"C_Header\",\n\n  data() {\n    return {\n      user: {\n        name: \"\",\n        status: false // true表示登录\n\n      },\n      selectedBtnClass: \"headerButton_selected\",\n      defaultPage: 1\n    };\n  },\n\n  props: ['accountPage', 'functionPage', 'switchFunctionPage', 'singleOrMulti'],\n  computed: {\n    userStatusColor() {\n      if (this.user.status) {\n        return {\n          color: \"forestgreen\"\n        };\n      } else {\n        return {\n          color: \"red\"\n        };\n      }\n    }\n\n  },\n\n  mounted() {\n    // 检查账户状态\n    this.accountStatusCheck();\n    this.$bus.$on('changeStatus', data => {\n      this.user.status = data.status;\n      this.user.name = data.uname;\n    });\n  },\n\n  beforeDestroy() {\n    this.$bus.$off('changeStatus');\n  },\n\n  methods: {\n    switchMainPage(key, keyPath) {\n      console.log(key, keyPath);\n    },\n\n    // cookie\n    getCookie(objname) {\n      //获取指定名称的cookie的值\n      const arrstr = document.cookie.split(\"; \");\n\n      for (let i = 0; i < arrstr.length; i++) {\n        const temp = arrstr[i].split(\"=\");\n        if (temp[0] === objname) return temp[1];\n      }\n\n      return null;\n    },\n\n    setCookie(name, value, hours, path) {\n      const expires = new Date();\n      expires.setTime(expires.getTime() + hours * 3600000);\n      path = path === \"\" ? \"\" : \";path=\" + path;\n\n      const _expires = typeof hours == \"string\" ? \"\" : \";expires=\" + expires.toUTCString();\n\n      document.cookie = name + \"=\" + value + _expires + path;\n    },\n\n    clearCookie(name) {\n      this.setCookie(name, \"\", -1, \"/NBI\");\n    },\n\n    getToken() {\n      return this.getCookie(\"NBI_token\");\n    },\n\n    getUID() {\n      return this.getCookie(\"NBI_UID\");\n    },\n\n    accountStatusCheck() {\n      // 本地无token，未登录\n      const token = this.getToken();\n\n      if (token === null) {\n        this.user.status = false;\n        return;\n      } // 本地有token，与uid一起上传\n\n\n      const uid = this.getUID();\n      const fd = new FormData();\n      fd.append(\"uid\", uid);\n      fd.append(\"token\", token);\n      let config = {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      };\n      this.$axios.post('/NBI/User/checkByToken/', fd, config).then(response => {\n        const checkResult = response.data.check;\n        const newToken = response.data.token;\n        const uname = response.data.uname;\n\n        if (checkResult === 0) {\n          this.user.status = false;\n        } else if (checkResult === 1) {\n          this.user.status = false;\n          this.$message({\n            message: '您的登录已过期！',\n            type: 'error'\n          });\n          this.clearCookie(\"NBI_token\");\n        } else if (checkResult === 2) {\n          this.setCookie(\"NBI_token\", newToken, 2, \"/NBI\");\n          this.user.name = uname;\n          this.user.status = true;\n        }\n      });\n    },\n\n    jumpToIDMG() {\n      window.location.href = \"https://teacher.bupt.edu.cn/shaoyingxia/zh_CN/\";\n    },\n\n    singleOrMultiSwitch(w) {\n      this.singleOrMulti(w);\n    }\n\n  }\n};","map":{"version":3,"mappings":"AA4DA;EACAA,gBADA;;EAEAC;IACA;MACAC;QACAF,QADA;QAEAG,aAFA,CAEA;;MAFA,CADA;MAKAC,yCALA;MAMAC;IANA;EAQA,CAXA;;EAYAC,6EAZA;EAaAC;IACAC;MACA;QACA;UAAAC;QAAA;MACA,CAFA,MAGA;QACA;UAAAA;QAAA;MACA;IACA;;EARA,CAbA;;EAuBAC;IACA;IACA;IACA;MACA;MACA;IACA,CAHA;EAIA,CA9BA;;EA+BAC;IACA;EACA,CAjCA;;EAkCAC;IACAC;MACAC;IACA,CAHA;;IAIA;IACAC;MAAA;MACA;;MACA;QACA;QACA;MACA;;MACA;IACA,CAZA;;IAaAC;MACA;MACAC;MACAC;;MACA;;MACAC;IACA,CAnBA;;IAoBAC;MACA;IACA,CAtBA;;IAuBAC;MACA;IACA,CAzBA;;IA0BAC;MACA;IACA,CA5BA;;IA6BAC;MACA;MACA;;MACA;QACA;QACA;MACA,CANA,CAQA;;;MACA;MACA;MACAC;MACAA;MACA;QACAC;UAAA;QAAA;MADA;MAGA;QACA;QACA;QACA;;QACA;UACA;QACA,CAFA,MAGA;UACA;UACA;YACAC,mBADA;YAEAC;UAFA;UAIA;QACA,CAPA,MAQA;UACA;UACA;UACA;QACA;MACA,CApBA;IAqBA,CAlEA;;IAmEAC;MACAC;IACA,CArEA;;IAsEAC;MACA;IACA;;EAxEA;AAlCA","names":["name","data","user","status","selectedBtnClass","defaultPage","props","computed","userStatusColor","color","mounted","beforeDestroy","methods","switchMainPage","console","getCookie","setCookie","expires","path","document","clearCookie","getToken","getUID","accountStatusCheck","fd","headers","message","type","jumpToIDMG","window","singleOrMultiSwitch"],"sourceRoot":"src/components","sources":["Header.vue"],"sourcesContent":["<template>\r\n    <div id=\"mainPageHeader\">\r\n        <div id=\"iconContainer\">\r\n            <img src=\"@/assets/webicon.jpg\" alt=\"图片加载失败\" style=\"height: 82%; align-self: center; border-radius: 50%\">\r\n        </div>\r\n        <div id=\"nameContainer\">\r\n            <div style=\"width: 100%; text-align: left; height: 45%; display: inline-flex;\">\r\n                <p class=\"headerFont\" style=\"color: #d1ffd3\">\r\n                        NBI\r\n                </p>\r\n                <p class=\"headerFont\" style=\"margin-left: 10px; color: rgba(154,198,255,0.95)\">\r\n                        -\r\n                </p>\r\n                <p class=\"headerFont\" style=\"margin-left: 10px\">\r\n                        Online\r\n                </p>\r\n            </div>\r\n            <div style=\"width: 100%; text-align: left; height: 25%; display: inline-flex;cursor: pointer\" @click=\"jumpToIDMG()\">\r\n                <p class=\"headerFont2\">\r\n                        BUPT\r\n                </p>\r\n                <p class=\"headerFont2\" style=\"margin-left: 10px\">\r\n                        IDMG\r\n                </p>\r\n            </div>\r\n        </div>\r\n      <div id=\"switchBtnContainer\">\r\n        <div class=\"headerButton\" :class=\"functionPage===1? selectedBtnClass:''\"  @click=\"switchFunctionPage(1)\">\r\n          <el-dropdown :hide-on-click=\"false\" style=\"color: white;font-size: small\">\r\n            <span class=\"el-dropdown-link\">\r\n              Image Process<i class=\"el-icon-arrow-down el-icon--right\"></i>\r\n            </span>\r\n            <el-dropdown-menu slot=\"dropdown\">\r\n              <el-dropdown-item>\r\n                <div style=\"font-family: STHeiti\" @click=\"singleOrMultiSwitch(1)\">Single Image Process</div>\r\n              </el-dropdown-item>\r\n              <el-dropdown-item>\r\n                <div style=\"font-family: STHeiti\" @click=\"singleOrMultiSwitch(2)\">Batch Process</div>\r\n              </el-dropdown-item>\r\n            </el-dropdown-menu>\r\n          </el-dropdown>\r\n        </div>\r\n\r\n        <div class=\"headerButton\" :class=\"functionPage===2? selectedBtnClass:''\"  @click=\"switchFunctionPage(2)\"><p>User Center</p></div>\r\n        <div class=\"headerButton\" :class=\"functionPage===3? selectedBtnClass:''\"  @click=\"switchFunctionPage(3)\"><p>History Data</p></div>\r\n      </div>\r\n        <div id=\"accountInfoContainer\">\r\n          <div v-show=\"user.status\" id=\"loginStatusContainer\">\r\n            <div class=\"accountName\" title=\"用户中心\" @click=\"switchFunctionPage(2)\">{{ user.name }}</div>\r\n          </div>\r\n          <div v-show=\"!user.status\" id=\"accountStatusContainer\">-->\r\n            <div class=\"accountBtn\" title=\"登录\" @click=\"accountPage(1)\">Sign In</div>\r\n            <div style=\"width: 2px; height: 50%;margin-left:10px;margin-right: 10px;background-color: #F8F8FF;\"></div>\r\n            <div class=\"accountBtn\" title=\"注册\" @click=\"accountPage(2)\">Sign Up</div>\r\n          </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"C_Header\",\r\n  data(){\r\n    return {\r\n      user:{\r\n          name: \"\",\r\n          status: false, // true表示登录\r\n      },\r\n      selectedBtnClass: \"headerButton_selected\",\r\n      defaultPage: 1,\r\n    }\r\n  },\r\n  props:['accountPage', 'functionPage', 'switchFunctionPage','singleOrMulti'],\r\n  computed:{\r\n    userStatusColor(){\r\n      if (this.user.status){\r\n        return {color: \"forestgreen\"};\r\n      }\r\n      else{\r\n        return {color: \"red\"};\r\n      }\r\n    }\r\n  },\r\n  mounted(){\r\n    // 检查账户状态\r\n    this.accountStatusCheck();\r\n    this.$bus.$on('changeStatus', (data)=>{\r\n      this.user.status = data.status;\r\n      this.user.name = data.uname;\r\n    });\r\n  },\r\n  beforeDestroy() {\r\n    this.$bus.$off('changeStatus');\r\n  },\r\n  methods:{\r\n    switchMainPage(key, keyPath){\r\n      console.log(key, keyPath);\r\n    },\r\n    // cookie\r\n    getCookie(objname){//获取指定名称的cookie的值\r\n      const arrstr = document.cookie.split(\"; \");\r\n      for(let i = 0; i < arrstr.length; i ++){\r\n        const temp = arrstr[i].split(\"=\");\r\n        if(temp[0] === objname) return temp[1];\r\n      }\r\n      return null;\r\n    },\r\n    setCookie(name, value, hours, path) {\r\n      const expires = new Date();\r\n      expires.setTime(expires.getTime() + hours * 3600000);\r\n      path = path === \"\" ? \"\" : \";path=\" + path;\r\n      const _expires = (typeof hours) == \"string\" ? \"\" : \";expires=\" + expires.toUTCString();\r\n      document.cookie = name + \"=\" + value + _expires + path;\r\n    },\r\n    clearCookie(name) {\r\n      this.setCookie(name, \"\", -1, \"/NBI\");\r\n    },\r\n    getToken(){\r\n      return this.getCookie(\"NBI_token\");\r\n    },\r\n    getUID(){\r\n      return this.getCookie(\"NBI_UID\");\r\n    },\r\n    accountStatusCheck(){\r\n      // 本地无token，未登录\r\n      const token = this.getToken();\r\n      if (token === null){\r\n        this.user.status = false;\r\n        return;\r\n      }\r\n\r\n      // 本地有token，与uid一起上传\r\n      const uid = this.getUID();\r\n      const fd = new FormData();\r\n      fd.append(\"uid\",uid);\r\n      fd.append(\"token\",token);\r\n      let config = {\r\n         headers: {'Content-Type': 'multipart/form-data'}\r\n      };\r\n      this.$axios.post('/NBI/User/checkByToken/', fd, config).then((response) => {\r\n        const checkResult = response.data.check;\r\n        const newToken = response.data.token;\r\n        const uname = response.data.uname;\r\n        if (checkResult === 0){\r\n          this.user.status = false;\r\n        }\r\n        else if(checkResult === 1){\r\n          this.user.status = false;\r\n          this.$message({\r\n            message: '您的登录已过期！',\r\n            type: 'error',\r\n          });\r\n          this.clearCookie(\"NBI_token\");\r\n        }\r\n        else if(checkResult === 2){\r\n          this.setCookie(\"NBI_token\",newToken, 2, \"/NBI\");\r\n          this.user.name = uname;\r\n          this.user.status = true;\r\n        }\r\n      });\r\n    },\r\n    jumpToIDMG(){\r\n      window.location.href = \"https://teacher.bupt.edu.cn/shaoyingxia/zh_CN/\";\r\n    },\r\n    singleOrMultiSwitch(w){\r\n      this.singleOrMulti(w);\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n#mainPageHeader{\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: #07004f;\r\n    background-repeat:no-repeat;\r\n    overflow: hidden;\r\n    float: right;\r\n    display: flex;\r\n    align-items: center;\r\n    z-index: 100;\r\n}\r\n.headerFont{\r\n  color: #f0f7ff;\r\n  line-height: 90%;\r\n  vertical-align: center;\r\n  font-family: STHeiti;\r\n}\r\n.headerFont2{\r\n  color: #f0f7ff;\r\n  font-size: 70%;\r\n  line-height: 90%;\r\n  vertical-align: center;\r\n  font-family: STHeiti;\r\n}\r\n#iconContainer{\r\n    height: 70%;\r\n    margin-left: 4%;\r\n    width: 6%;\r\n    display: flex;\r\n    justify-content: center;\r\n    overflow: hidden;\r\n}\r\n\r\n#nameContainer{\r\n    height: 100%;\r\n    width: 22%;\r\n    margin-left: 3%;\r\n}\r\n#switchBtnContainer{\r\n  height: 100%;\r\n  width: 35%;\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: center;\r\n  justify-content: flex-end;\r\n}\r\n#accountInfoContainer{\r\n  height: 100%;\r\n  width: 30%;\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: center;\r\n  justify-content: flex-end;\r\n}\r\n#accountStatusContainer{\r\n    width: 100%;\r\n    height: 100%;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    flex-direction: row;\r\n    overflow: hidden;\r\n}\r\n#loginStatusContainer{\r\n    width: 100%;\r\n    height: 100%;\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    align-items: center;\r\n    flex-direction: row;\r\n    overflow: hidden;\r\n    margin-right: 5%;\r\n}\r\n.accountBtn{\r\n  width: 30%;\r\n  height: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: #fff0d5;\r\n  font-family: STHeiti;\r\n  font-size: small;\r\n  border-radius: 5px;\r\n  border: #F8F8FF 2px solid;\r\n  transition: 0.3s ease;\r\n}\r\n.accountBtn:hover{\r\n  cursor: pointer;\r\n  background-color: #F8F8FF;\r\n  color: #2a2a2a;\r\n}\r\n.accountName{\r\n  width: 50%;\r\n  height: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: #fff0d5;\r\n  font-family: STHeiti;\r\n  font-size: small;\r\n  border-bottom: rgba(248, 248, 255, 0.3) 2px solid;\r\n  background-color: rgba(248, 248, 255, 0.15);\r\n  border-radius: 5px;\r\n  overflow: hidden;\r\n  cursor: pointer;\r\n}\r\n.headerButton{\r\n    cursor: pointer;\r\n    font-family: STHeiti;\r\n    height: 45%;\r\n    font-size: small;\r\n    font-weight: bold;\r\n    width: 28%;\r\n    transition: 0.3s ease;\r\n    background: rgba(255, 255, 255, 0);\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    color: #ffffff;\r\n    margin-left: 2%;\r\n}\r\n.headerButton_selected{\r\n    background: rgba(255, 255, 255, 0.16);\r\n    color: rgb(245, 225, 225);\r\n    border-bottom: 1px white solid;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}